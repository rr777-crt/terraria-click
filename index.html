<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–®–∞–≥ –∑–∞ —à–∞–≥–æ–º</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
            background-color: #f5f5f5;
            color: #333;
        }
        
        .game-container {
            background-color: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 20px;
        }
        
        button {
            padding: 10px 20px;
            margin: 8px;
            font-size: 16px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            transition: all 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            font-weight: bold;
        }
        
        #stepBtn, .shop button {
            background-color: #2ecc71;
            color: white;
        }
        
        .battle-actions button {
            background-color: #e74c3c;
            color: white;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        button:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .stats {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            margin-bottom: 25px;
            background-color: #ecf0f1;
            padding: 15px;
            border-radius: 10px;
            gap: 10px;
        }
        
        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 100px;
        }
        
        .hp-bar-container, .enemy-hp-bar-container {
            width: 100px;
            height: 20px;
            background-color: #ecf0f1;
            border-radius: 10px;
            margin: 5px 0;
            overflow: hidden;
            position: relative;
        }
        
        .hp-bar, .enemy-hp-bar {
            height: 100%;
            background-color: #2ecc71;
            width: 100%;
            transition: width 0.5s;
        }
        
        .enemy-hp-bar {
            background-color: #e74c3c;
        }
        
        .hp-text, .enemy-hp-text {
            position: absolute;
            width: 100%;
            text-align: center;
            line-height: 20px;
            font-size: 12px;
            color: white;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.5);
        }
        
        .battle-actions {
            display: none;
            margin-top: 25px;
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #e74c3c;
        }
        
        .shop {
            display: none;
            margin-top: 20px;
            border: 2px solid #2ecc71;
            padding: 15px;
            border-radius: 10px;
            background-color: #f8f9fa;
        }
        
        .inventory {
            margin-top: 20px;
            border: 2px solid #3498db;
            padding: 15px;
            border-radius: 10px;
            background-color: #f8f9fa;
        }
        
        .inventory-item {
            margin: 8px;
            padding: 8px 12px;
            background-color: #3498db;
            color: white;
            border-radius: 20px;
            display: inline-block;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .inventory-item:hover {
            background-color: #2980b9;
            transform: scale(1.05);
        }
        
        #log {
            margin-top: 20px;
            max-height: 150px;
            overflow-y: auto;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
            text-align: left;
        }
        
        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-bottom: 1px solid #ddd;
        }
        
        .enemy-info {
            margin: 15px 0;
            font-weight: bold;
        }
        
        .mining-container {
            display: none;
            margin-top: 15px;
            padding: 10px;
            background-color: #f39c12;
            border-radius: 5px;
            color: white;
        }
        
        .mining-progress {
            height: 20px;
            background-color: #d35400;
            border-radius: 10px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .mining-progress-bar {
            height: 100%;
            background-color: #f1c40f;
            width: 0%;
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>–®–∞–≥ –∑–∞ —à–∞–≥–æ–º</h1>
        
        <div class="stats">
            <div class="stat-item">
                <div>–®–∞–≥–∏</div>
                <div id="steps">0</div>
            </div>
            <div class="stat-item">
                <div>–ú–æ–Ω–µ—Ç—ã</div>
                <div id="coins">0</div>
            </div>
            <div class="stat-item">
                <div>–ó–¥–æ—Ä–æ–≤—å–µ</div>
                <div class="hp-bar-container">
                    <div class="hp-bar" id="hpBar"></div>
                    <div class="hp-text" id="hpText">5/5</div>
                </div>
            </div>
            <div class="stat-item">
                <div>–£—Ä–æ–Ω</div>
                <div id="damage">1</div>
            </div>
            <div class="stat-item">
                <div>–ó–∞—â–∏—Ç–∞</div>
                <div id="defense">0%</div>
            </div>
        </div>
        
        <button id="stepBtn">–°–î–ï–õ–ê–¢–¨ –®–ê–ì</button>
        
        <div class="battle-actions" id="battleActions">
            <h2>‚öîÔ∏è –ë–∏—Ç–≤–∞! ‚öîÔ∏è</h2>
            <div class="enemy-info">
                <p>–í—Ä–∞–≥: <span id="enemyHpText">5</span> HP</p>
                <p>–£—Ä–æ–Ω: 1</p>
            </div>
            <div class="enemy-hp-bar-container">
                <div class="enemy-hp-bar" id="enemyHpBar"></div>
                <div class="enemy-hp-text" id="enemyHpFullText">5/5</div>
            </div>
            <div>
                <button id="attackBtn">–ê—Ç–∞–∫–æ–≤–∞—Ç—å</button>
                <button id="defendBtn">–ó–∞—â–∏—â–∞—Ç—å—Å—è</button>
                <button id="dodgeBtn">–£–≤–µ—Ä–Ω—É—Ç—å—Å—è (<span id="dodgesLeft">3</span>)</button>
            </div>
        </div>
        
        <div class="mining-container" id="miningContainer">
            <h3>‚õèÔ∏è –ù–∞–π–¥–µ–Ω –º–∏–Ω–µ—Ä–∞–ª!</h3>
            <p>–ö–ª–∏–∫–Ω–∏—Ç–µ –ø–æ –∫–∏—Ä–∫–µ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ, —á—Ç–æ–±—ã –¥–æ–±—ã—Ç—å (40 –∫–ª–∏–∫–æ–≤)</p>
            <div class="mining-progress">
                <div class="mining-progress-bar" id="miningProgress"></div>
            </div>
        </div>
        
        <div class="shop" id="shop">
            <h2>üõí –ú–∞–≥–∞–∑–∏–Ω</h2>
            <button id="swordBtn">üó°Ô∏è –ú–µ—á (150 –º–æ–Ω–µ—Ç) - 4 —É—Ä–æ–Ω–∞</button>
            <button id="bowBtn">üèπ –õ—É–∫ (300 –º–æ–Ω–µ—Ç) - 3-6 —É—Ä–æ–Ω–∞</button>
            <button id="glovesBtn">üß§ –ü–µ—Ä—á–∞—Ç–∫–∏ (100 –º–æ–Ω–µ—Ç) - +2 —É—Ä–æ–Ω–∞</button>
            <button id="armorBtn">üõ°Ô∏è –ñ–µ–ª–µ–∑–Ω–∞—è –±—Ä–æ–Ω—è (200 –º–æ–Ω–µ—Ç) - 20% –∑–∞—â–∏—Ç—ã</button>
            <button id="healthBtn">‚ù§Ô∏è +1 –∫ –ú–∞–∫—Å –•–ü (25 –º–æ–Ω–µ—Ç)</button>
            <button id="lifeOrbBtn">üîµ –°—Ñ–µ—Ä–∞ –∂–∏–∑–Ω–∏ (50 –º–æ–Ω–µ—Ç) - +10 –•–ü</button>
            <button id="healthPotionBtn">üß™ –ó–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è (150 –º–æ–Ω–µ—Ç) - +100 –•–ü</button>
            <button id="rageOrbBtn">üî¥ –°—Ñ–µ—Ä–∞ —è—Ä–æ—Å—Ç–∏ (25 –º–æ–Ω–µ—Ç) - —Å–ª–µ–¥—É—é—â–∏–π —É–¥–∞—Ä x2</button>
            <button id="pickaxeBtn">‚õèÔ∏è –ö–∏—Ä–∫–∞ (10 –º–æ–Ω–µ—Ç) - –¥–æ–±—ã—á–∞ –º–∏–Ω–µ—Ä–∞–ª–æ–≤</button>
            <div id="chestContainer"></div>
        </div>
        
        <div class="inventory" id="inventory">
            <h3>üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h3>
            <div id="inventoryItems">–ü—É—Å—Ç–æ</div>
        </div>
        
        <div id="log"></div>
    </div>
    
    <script>
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let steps = 0;
        let coins = 0;
        let health = 5;
        let maxHealth = 5;
        let baseDamage = 1;
        let damageModifier = 0;
        let inBattle = false;
        let enemyHealth = 0;
        let enemyMaxHealth = 5;
        let enemyDamage = 1;
        let dodgesLeft = 3;
        let isPlayerTurn = true;
        let defendMode = false;
        let inventory = [];
        let rageActive = false;
        let enemyAttackTimeout = null;
        let defense = 0;
        let miningActive = false;
        let miningProgress = 0;
        let miningRequired = 40;
        let chestFound = false;
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const stepBtn = document.getElementById('stepBtn');
        const battleActions = document.getElementById('battleActions');
        const attackBtn = document.getElementById('attackBtn');
        const defendBtn = document.getElementById('defendBtn');
        const dodgeBtn = document.getElementById('dodgeBtn');
        const shop = document.getElementById('shop');
        const glovesBtn = document.getElementById('glovesBtn');
        const swordBtn = document.getElementById('swordBtn');
        const bowBtn = document.getElementById('bowBtn');
        const armorBtn = document.getElementById('armorBtn');
        const healthBtn = document.getElementById('healthBtn');
        const lifeOrbBtn = document.getElementById('lifeOrbBtn');
        const healthPotionBtn = document.getElementById('healthPotionBtn');
        const rageOrbBtn = document.getElementById('rageOrbBtn');
        const pickaxeBtn = document.getElementById('pickaxeBtn');
        const miningContainer = document.getElementById('miningContainer');
        const chestContainer = document.getElementById('chestContainer');
        
        // –§—É–Ω–∫—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateUI() {
            document.getElementById('steps').textContent = steps;
            document.getElementById('coins').textContent = coins;
            document.getElementById('defense').textContent = `${defense}%`;
            
            // –†–∞—Å—Å—á–µ—Ç —É—Ä–æ–Ω–∞
            const damage = baseDamage + damageModifier;
            document.getElementById('damage').textContent = damage > 1 ? `${damage} (${baseDamage}+${damageModifier})` : damage;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ HP –∏–≥—Ä–æ–∫–∞
            const hpPercent = (health / maxHealth) * 100;
            document.getElementById('hpBar').style.width = `${hpPercent}%`;
            document.getElementById('hpText').textContent = `${health}/${maxHealth}`;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ HP –≤—Ä–∞–≥–∞
            if (inBattle) {
                const enemyHpPercent = (enemyHealth / enemyMaxHealth) * 100;
                document.getElementById('enemyHpBar').style.width = `${enemyHpPercent}%`;
                document.getElementById('enemyHpText').textContent = enemyHealth;
                document.getElementById('enemyHpFullText').textContent = `${enemyHealth}/${enemyMaxHealth}`;
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            const inventoryItems = document.getElementById('inventoryItems');
            if (inventory.length === 0) {
                inventoryItems.innerHTML = '–ü—É—Å—Ç–æ';
            } else {
                inventoryItems.innerHTML = '';
                inventory.forEach(item => {
                    const itemEl = document.createElement('div');
                    itemEl.className = 'inventory-item';
                    itemEl.textContent = item;
                    
                    // –û—Å–æ–±—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤
                    if (item === '–ö–∏—Ä–∫–∞' && miningActive) {
                        itemEl.style.backgroundColor = '#f39c12';
                        itemEl.onclick = () => mineMineral();
                    } else if (item === '–°—Ñ–µ—Ä–∞ –∂–∏–∑–Ω–∏' || item === '–°—Ñ–µ—Ä–∞ —è—Ä–æ—Å—Ç–∏' || item === '–ó–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è') {
                        itemEl.onclick = () => useItem(item);
                    } else {
                        itemEl.style.cursor = 'default';
                    }
                    
                    inventoryItems.appendChild(itemEl);
                });
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –º–∞–≥–∞–∑–∏–Ω –∫–∞–∂–¥—ã–µ 10 —à–∞–≥–æ–≤
            if (steps > 0 && steps % 10 === 0 && !inBattle && !miningActive) {
                shop.style.display = 'block';
                
                // 50% —à–∞–Ω—Å –Ω–∞–π—Ç–∏ —Å—É–Ω–¥—É–∫
                if (!chestFound && Math.random() < 0.5) {
                    chestContainer.innerHTML = '<button id="chestBtn" style="background-color:#f1c40f;color:#000;">üéÅ –°—É–Ω–¥—É–∫ (100 –º–æ–Ω–µ—Ç)</button>';
                    document.getElementById('chestBtn').addEventListener('click', openChest);
                    chestFound = true;
                }
            } else {
                shop.style.display = 'none';
            }
            
            // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–Ω–æ–ø–æ–∫ –≤–æ –≤—Ä–µ–º—è —Ö–æ–¥–∞ –≤—Ä–∞–≥–∞
            attackBtn.disabled = !isPlayerTurn || !inBattle;
            defendBtn.disabled = !isPlayerTurn || !inBattle;
            dodgeBtn.disabled = !inBattle || dodgesLeft <= 0;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ª–æ–≥
        function addLog(message) {
            const log = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.textContent = message;
            log.prepend(entry);
            
            // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π –≤ –ª–æ–≥–µ
            if (log.children.length > 10) {
                log.removeChild(log.lastChild);
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è —à–∞–≥–∞
        function makeStep() {
            if (inBattle || miningActive) return;
            
            steps++;
            chestFound = false;
            
            // –ü–æ–ª—É—á–µ–Ω–∏–µ –º–æ–Ω–µ—Ç
            const coinsEarned = Math.floor(Math.random() * 25) + 1;
            coins += coinsEarned;
            addLog(`–í—ã —Å–¥–µ–ª–∞–ª–∏ —à–∞–≥ –∏ –ø–æ–ª—É—á–∏–ª–∏ ${coinsEarned} –º–æ–Ω–µ—Ç!`);
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—Å—Ç—Ä–µ—á—É —Å –≤—Ä–∞–≥–æ–º (30% —à–∞–Ω—Å)
            if (Math.random() < 0.3) {
                startBattle();
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –º–∏–Ω–µ—Ä–∞–ª–∞ (5% —à–∞–Ω—Å, –µ—Å–ª–∏ –µ—Å—Ç—å –∫–∏—Ä–∫–∞)
            if (inventory.includes('–ö–∏—Ä–∫–∞') && Math.random() < 0.05) {
                startMining();
            }
            
            updateUI();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –Ω–∞—á–∞–ª–∞ –±–∏—Ç–≤—ã
        function startBattle() {
            inBattle = true;
            
            // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è –≤—Ä–∞–≥–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–æ–π–¥–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤
            if (steps >= 60) {
                enemyMaxHealth = 35;
                enemyDamage = 3;
            } else if (steps >= 20) {
                enemyMaxHealth = 15;
                enemyDamage = 2;
            } else {
                enemyMaxHealth = 5;
                enemyDamage = 1;
            }
            
            enemyHealth = enemyMaxHealth;
            dodgesLeft = 3;
            isPlayerTurn = true;
            defendMode = false;
            
            battleActions.style.display = 'block';
            stepBtn.disabled = true;
            
            addLog(`–í—ã –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏ –≤—Ä–∞–≥–∞! (${enemyMaxHealth} HP, –£—Ä–æ–Ω: ${enemyDamage}) –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –±–∏—Ç–≤–∞!`);
            updateUI();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –±–∏—Ç–≤—ã
        function endBattle() {
            inBattle = false;
            battleActions.style.display = 'none';
            stepBtn.disabled = false;
            
            // –û—á–∏—Å—Ç–∫–∞ —Ç–∞–π–º–µ—Ä–∞ –∞—Ç–∞–∫–∏ –≤—Ä–∞–≥–∞
            if (enemyAttackTimeout) {
                clearTimeout(enemyAttackTimeout);
                enemyAttackTimeout = null;
            }
            
            updateUI();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∞—Ç–∞–∫–∏ –∏–≥—Ä–æ–∫–∞
        function playerAttack() {
            if (!isPlayerTurn || !inBattle) return;
            
            let attackDamage = baseDamage + damageModifier;
            if (rageActive) {
                attackDamage *= 2;
                rageActive = false;
                addLog('–°—Ñ–µ—Ä–∞ —è—Ä–æ—Å—Ç–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞! –£—Ä–æ–Ω —É–¥–≤–æ–µ–Ω!');
            }
            
            // –î–ª—è –ª—É–∫–∞ - —Å–ª—É—á–∞–π–Ω—ã–π —É—Ä–æ–Ω –æ—Ç 3 –¥–æ 6
            if (inventory.includes('–õ—É–∫')) {
                attackDamage = Math.floor(Math.random() * 4) + 3;
                addLog(`–í—ã —Å—Ç—Ä–µ–ª—è–µ—Ç–µ –∏–∑ –ª—É–∫–∞ –∏ –Ω–∞–Ω–æ—Å–∏—Ç–µ ${attackDamage} —É—Ä–æ–Ω–∞!`);
            } else {
                addLog(`–í—ã –∞—Ç–∞–∫—É–µ—Ç–µ –≤—Ä–∞–≥–∞ –∏ –Ω–∞–Ω–æ—Å–∏—Ç–µ ${attackDamage} —É—Ä–æ–Ω–∞!`);
            }
            
            enemyHealth -= attackDamage;
            
            if (enemyHealth <= 0) {
                enemyHealth = 0;
                addLog('–í—ã –ø–æ–±–µ–¥–∏–ª–∏ –≤—Ä–∞–≥–∞!');
                endBattle();
                return;
            }
            
            isPlayerTurn = false;
            updateUI();
            
            // –•–æ–¥ –≤—Ä–∞–≥–∞ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            enemyAttackTimeout = setTimeout(enemyTurn, 3000);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∑–∞—â–∏—Ç—ã –∏–≥—Ä–æ–∫–∞
        function playerDefend() {
            if (!isPlayerTurn || !inBattle) return;
            
            defendMode = true;
            addLog('–í—ã –≥–æ—Ç–æ–≤–∏—Ç–µ—Å—å –∫ –∑–∞—â–∏—Ç–µ!');
            
            isPlayerTurn = false;
            updateUI();
            
            // –•–æ–¥ –≤—Ä–∞–≥–∞ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            enemyAttackTimeout = setTimeout(enemyTurn, 3000);
        }
        
        // –§—É–Ω–∫—Ü–∏—è —É–≤–æ—Ä–æ—Ç–∞ –∏–≥—Ä–æ–∫–∞
        function playerDodge() {
            if (!inBattle || dodgesLeft <= 0) return;
            
            dodgesLeft--;
            addLog('–í—ã —É–≤–µ—Ä–Ω—É–ª–∏—Å—å –æ—Ç –∞—Ç–∞–∫–∏ –≤—Ä–∞–≥–∞!');
            
            // –ï—Å–ª–∏ —É–≤–µ—Ä–Ω—É–ª–∏—Å—å –≤–æ –≤—Ä–µ–º—è —Ö–æ–¥–∞ –≤—Ä–∞–≥–∞, –æ—Ç–º–µ–Ω—è–µ–º –µ–≥–æ –∞—Ç–∞–∫—É
            if (!isPlayerTurn && enemyAttackTimeout) {
                clearTimeout(enemyAttackTimeout);
                isPlayerTurn = true;
                addLog('–í—ã –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏–ª–∏ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É!');
            }
            
            updateUI();
        }
        
        // –•–æ–¥ –≤—Ä–∞–≥–∞
        function enemyTurn() {
            if (!inBattle) return;
            
            let damageTaken = enemyDamage;
            
            // –£—á–µ—Ç –∑–∞—â–∏—Ç—ã
            if (defense > 0) {
                const damageReduction = Math.floor(damageTaken * (defense / 100));
                damageTaken -= damageReduction;
                addLog(`–í–∞—à–∞ –±—Ä–æ–Ω—è —É–º–µ–Ω—å—à–∏–ª–∞ —É—Ä–æ–Ω –Ω–∞ ${damageReduction}!`);
            }
            
            if (defendMode) {
                damageTaken = Math.max(1, Math.floor(damageTaken * 0.5));
                addLog(`–í—Ä–∞–≥ –∞—Ç–∞–∫—É–µ—Ç, –Ω–æ –≤—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏ —á–∞—Å—Ç—å —É—Ä–æ–Ω–∞! (–ü–æ–ª—É—á–µ–Ω–æ ${damageTaken} —É—Ä–æ–Ω–∞)`);
                defendMode = false;
            } else {
                addLog(`–í—Ä–∞–≥ –∞—Ç–∞–∫—É–µ—Ç –∏ –Ω–∞–Ω–æ—Å–∏—Ç ${damageTaken} —É—Ä–æ–Ω–∞!`);
            }
            
            health -= damageTaken;
            
            if (health <= 0) {
                health = 0;
                addLog('–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏! –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞.');
                endBattle();
                stepBtn.disabled = true;
                return;
            }
            
            isPlayerTurn = true;
            updateUI();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–µ–¥–º–µ—Ç–∞ –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        function useItem(item) {
            if (item === '–°—Ñ–µ—Ä–∞ –∂–∏–∑–Ω–∏') {
                health = Math.min(health + 10, maxHealth);
                inventory = inventory.filter(i => i !== item);
                addLog('–í—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –°—Ñ–µ—Ä—É –∂–∏–∑–Ω–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ 10 HP!');
            } else if (item === '–°—Ñ–µ—Ä–∞ —è—Ä–æ—Å—Ç–∏') {
                rageActive = true;
                inventory = inventory.filter(i => i !== item);
                addLog('–í—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª–∏ –°—Ñ–µ—Ä—É —è—Ä–æ—Å—Ç–∏! –°–ª–µ–¥—É—é—â–∞—è –∞—Ç–∞–∫–∞ –±—É–¥–µ—Ç —Å–∏–ª—å–Ω–µ–µ!');
            } else if (item === '–ó–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è') {
                health = maxHealth;
                inventory = inventory.filter(i => i !== item);
                addLog('–í—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –ó–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ HP!');
            }
            
            updateUI();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –Ω–∞—á–∞–ª–∞ –¥–æ–±—ã—á–∏ –º–∏–Ω–µ—Ä–∞–ª–∞
        function startMining() {
            miningActive = true;
            miningProgress = 0;
            miningContainer.style.display = 'block';
            addLog('–í—ã –Ω–∞—à–ª–∏ –º–∏–Ω–µ—Ä–∞–ª! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∏—Ä–∫—É –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è, —á—Ç–æ–±—ã –¥–æ–±—ã—Ç—å –µ–≥–æ.');
            updateUI();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–æ–±—ã—á–∏ –º–∏–Ω–µ—Ä–∞–ª–∞
        function mineMineral() {
            if (!miningActive) return;
            
            miningProgress++;
            document.getElementById('miningProgress').style.width = `${(miningProgress / miningRequired) * 100}%`;
            
            if (miningProgress >= miningRequired) {
                const minedCoins = Math.floor(Math.random() * 66) + 60;
                coins += minedCoins;
                addLog(`–í—ã –¥–æ–±—ã–ª–∏ –º–∏–Ω–µ—Ä–∞–ª –∏ –ø–æ–ª—É—á–∏–ª–∏ ${minedCoins} –º–æ–Ω–µ—Ç!`);
                miningActive = false;
                miningContainer.style.display = 'none';
            }
            
            updateUI();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è —Å—É–Ω–¥—É–∫–∞
        function openChest() {
            coins += 100;
            addLog('–í—ã –Ω–∞—à–ª–∏ —Å—É–Ω–¥—É–∫ —Å 100 –º–æ–Ω–µ—Ç–∞–º–∏!');
            chestContainer.innerHTML = '';
            updateUI();
        }
        
        // –ü–æ–∫—É–ø–∫–∏ –≤ –º–∞–≥–∞–∑–∏–Ω–µ
        function buySword() {
            if (coins >= 150) {
                coins -= 150;
                baseDamage = 4; // –£—Ä–æ–Ω –Ω–µ —Å—É–º–º–∏—Ä—É–µ—Ç—Å—è, –∑–∞–º–µ–Ω—è–µ—Ç—Å—è
                damageModifier = 0;
                addLog('–í—ã –∫—É–ø–∏–ª–∏ –º–µ—á! –¢–µ–ø–µ—Ä—å –≤–∞—à —É—Ä–æ–Ω 4.');
                updateUI();
            } else {
                addLog('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –º–µ—á–∞!');
            }
        }
        
        function buyBow() {
            if (coins >= 300) {
                coins -= 300;
                baseDamage = 3; // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–Ω –ª—É–∫–∞
                damageModifier = 3; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–Ω –±—É–¥–µ—Ç 6 (3+3)
                addLog('–í—ã –∫—É–ø–∏–ª–∏ –ª—É–∫! –¢–µ–ø–µ—Ä—å –≤–∞—à —É—Ä–æ–Ω 3-6.');
                updateUI();
            } else {
                addLog('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –ª—É–∫–∞!');
            }
        }
        
        function buyGloves() {
            if (coins >= 100) {
                coins -= 100;
                damageModifier += 2;
                addLog('–í—ã –∫—É–ø–∏–ª–∏ –ø–µ—Ä—á–∞—Ç–∫–∏! –£—Ä–æ–Ω —É–≤–µ–ª–∏—á–µ–Ω –Ω–∞ 2.');
                updateUI();
            } else {
                addLog('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –ø–µ—Ä—á–∞—Ç–æ–∫!');
            }
        }
        
        function buyArmor() {
            if (coins >= 200) {
                coins -= 200;
                defense = 20;
                addLog('–í—ã –∫—É–ø–∏–ª–∏ –∂–µ–ª–µ–∑–Ω—É—é –±—Ä–æ–Ω—é! –¢–µ–ø–µ—Ä—å –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –Ω–∞ 20% –º–µ–Ω—å—à–µ —É—Ä–æ–Ω–∞.');
                updateUI();
            } else {
                addLog('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –±—Ä–æ–Ω–∏!');
            }
        }
        
        function buyHealthUpgrade() {
            if (coins >= 25) {
                coins -= 25;
                maxHealth += 1;
                health += 1;
                addLog('–í—ã —É–≤–µ–ª–∏—á–∏–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ –Ω–∞ 1!');
                updateUI();
            } else {
                addLog('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è!');
            }
        }
        
        function buyLifeOrb() {
            if (coins >= 50) {
                coins -= 50;
                inventory.push('–°—Ñ–µ—Ä–∞ –∂–∏–∑–Ω–∏');
                addLog('–í—ã –∫—É–ø–∏–ª–∏ –°—Ñ–µ—Ä—É –∂–∏–∑–Ω–∏!');
                updateUI();
            } else {
                addLog('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –°—Ñ–µ—Ä—ã –∂–∏–∑–Ω–∏!');
            }
        }
        
        function buyHealthPotion() {
            if (coins >= 150) {
                coins -= 150;
                inventory.push('–ó–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è');
                addLog('–í—ã –∫—É–ø–∏–ª–∏ –ó–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è!');
                updateUI();
            } else {
                addLog('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –ó–µ–ª—å—è –∑–¥–æ—Ä–æ–≤—å—è!');
            }
        }
        
        function buyRageOrb() {
            if (coins >= 25) {
                coins -= 25;
                inventory.push('–°—Ñ–µ—Ä–∞ —è—Ä–æ—Å—Ç–∏');
                addLog('–í—ã –∫—É–ø–∏–ª–∏ –°—Ñ–µ—Ä—É —è—Ä–æ—Å—Ç–∏!');
                updateUI();
            } else {
                addLog('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –°—Ñ–µ—Ä—ã —è—Ä–æ—Å—Ç–∏!');
            }
        }
        
        function buyPickaxe() {
            if (coins >= 10) {
                coins -= 10;
                inventory.push('–ö–∏—Ä–∫–∞');
                addLog('–í—ã –∫—É–ø–∏–ª–∏ –∫–∏—Ä–∫—É! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–±—ã–≤–∞—Ç—å –º–∏–Ω–µ—Ä–∞–ª—ã.');
                updateUI();
            } else {
                addLog('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∫–∏—Ä–∫–∏!');
            }
        }
        
        // –°–æ–±—ã—Ç–∏—è –∫–Ω–æ–ø–æ–∫
        stepBtn.addEventListener('click', makeStep);
        attackBtn.addEventListener('click', playerAttack);
        defendBtn.addEventListener('click', playerDefend);
        dodgeBtn.addEventListener('click', playerDodge);
        swordBtn.addEventListener('click', buySword);
        bowBtn.addEventListener('click', buyBow);
        glovesBtn.addEventListener('click', buyGloves);
        armorBtn.addEventListener('click', buyArmor);
        healthBtn.addEventListener('click', buyHealthUpgrade);
        lifeOrbBtn.addEventListener('click', buyLifeOrb);
        healthPotionBtn.addEventListener('click', buyHealthPotion);
        rageOrbBtn.addEventListener('click', buyRageOrb);
        pickaxeBtn.addEventListener('click', buyPickaxe);
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        updateUI();
    </script>
</body>
</html>
